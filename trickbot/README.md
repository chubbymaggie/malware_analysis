# TrickBot
Decoders for TrickBot's elements<br/>

+ <b>trick_decoder.py</b> - decodes TrickBot's core modules (32/64-bit bots) - from resources of the TrickBot loader executable (obsolete, works for the first version of TrickBot)
+ <b>trick_config_decoder.py</b> - decodes TrickBot's hardcoded configuration (from the resource) + downloaded modules and their configuration
+ <b>trick_settings_decoder.py</b> - decodes BotKey from the settings file (i.e. _settings.ini_ dropped in the TrickBot installation directory)
+ <b>make_bot_key.cpp</b> - a keygen for BotKey (must be run on the infected machine). Compiled version: [make_bot_key.exe](https://goo.gl/7Sf1E1)

2018-10-15: The new version of TrickBot came with some changes. Now, in order to be able to decrypt modules and their configuration, you need to supply an individual key, that is generated per victim machine.</br>
The key can be obtained in two ways:
+ decoded:
  + Use `trick_settings_decoder.py` and the settings file dropped by TrickBot.
+ generated:
  + Compile `make_bot_key.cpp` and run it on the same machine, where the encrypted files were dropped.
  
Then, you can pass the obtained key to `trick_config_decoder.py`. Example:
```
./trick_config_decoder.py --botkey 2E9EA9FE45FDBA4289F494AF959FAB1A828948E19309DD3C80AD4202728821DB --datafile Data/injectDll32
Decoded: 1390000 bytes
Dumped decoded to: Data/injectDll32.out
Extracted Module to: Data/injectDll32.dll
```
